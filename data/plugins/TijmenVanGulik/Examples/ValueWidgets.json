{"id":"tijmenvangulik_examples_valuewidgets","name":"Examples value widgets","description":"Example how to write simple value widgets","version":"1.0","author":"Tijmen van Gulik","url":"plugins/TijmenVanGulik/Examples/ValueWidgets.json","script":"var __extends = (this && this.__extends) || function (d, b) {\r\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\r\n    function __() { this.constructor = d; }\r\n    __.prototype = b.prototype;\r\n    d.prototype = new __();\r\n};\r\nvar tijmenvangulik_examples_valuewidgets;\r\n(function (tijmenvangulik_examples_valuewidgets) {\r\n    /*------------------------------------------------------------------------------\r\n        Stroke phase value widget example\r\n    ------------------------------------------------------------------------------*/\r\n    var ExamplePhaseValueWidget = (function (_super) {\r\n        __extends(ExamplePhaseValueWidget, _super);\r\n        function ExamplePhaseValueWidget(controller) {\r\n            _super.call(this, controller);\r\n            this.caption = \"Phase2\"; //menu item or window caption    \r\n        }\r\n        ExamplePhaseValueWidget.prototype.strokePhaseUpdate = function (phase, duration) {\r\n            this.valueText = phase.displayText;\r\n        };\r\n        ExamplePhaseValueWidget.prototype.loaded = function () {\r\n            _super.prototype.loaded.call(this);\r\n            pm3.monitor.pubsubs.subNewStrokePhase(this, this.strokePhaseUpdate);\r\n        };\r\n        ExamplePhaseValueWidget.prototype.beforeUnload = function () {\r\n            _super.prototype.beforeUnload.call(this);\r\n            pm3.monitor.pubsubs.unsubNewStrokePhase(this.strokePhaseUpdate);\r\n        };\r\n        ExamplePhaseValueWidget.prototype.initControl = function () {\r\n            _super.prototype.initControl.call(this);\r\n            this.labelText = \"Phase2\"; //label before value\r\n        };\r\n        return ExamplePhaseValueWidget;\r\n    })(ergometerWidgets.StrokeValueWidget);\r\n    /*------------------------------------------------------------------------------\r\n        Stroke power widget\r\n        note the base class  StrokeValueWidget connects the strokeDataUpdate to the event using\r\n        pm3.monitor.pubsubs.subStrokeDataUpdate(this, this.strokeDataUpdate);\r\n        see the ExamplePhaseValueWidget widget how to attach to events\r\n    ------------------------------------------------------------------------------*/\r\n    var ExampleStrokeValuePowerWidget = (function (_super) {\r\n        __extends(ExampleStrokeValuePowerWidget, _super);\r\n        function ExampleStrokeValuePowerWidget(controller) {\r\n            _super.call(this, controller);\r\n            this.caption = \"Power2\"; //no caption needed\r\n        }\r\n        ExampleStrokeValuePowerWidget.prototype.strokeDataUpdate = function (strokeData) {\r\n            this.valueText = strokeData.power.toString();\r\n        };\r\n        ExampleStrokeValuePowerWidget.prototype.initControl = function () {\r\n            _super.prototype.initControl.call(this);\r\n            this.labelText = \"Power\";\r\n        };\r\n        return ExampleStrokeValuePowerWidget;\r\n    })(ergometerWidgets.StrokeValueWidget);\r\n    /*------------------------------------------------------------------------------\r\n        training data widget (or workout)\r\n        note the base class  StrokeValueWidget connects the trainingDataUpdate to the event using\r\n          pm3.monitor.pubsubs.subTrainingDataUpdate(this, this.trainingDataUpdate);\r\n        see the ExamplePhaseValueWidget widget how to attach to events\r\n    ------------------------------------------------------------------------------*/\r\n    var ExampleTrainingDataWidget = (function (_super) {\r\n        __extends(ExampleTrainingDataWidget, _super);\r\n        function ExampleTrainingDataWidget(controller) {\r\n            this.caption = \"Workout2\";\r\n            _super.call(this, controller);\r\n        }\r\n        ExampleTrainingDataWidget.prototype.trainingDataUpdate = function (trainingData) {\r\n            if (trainingData.workoutType)\r\n                this.valueText = trainingData.workoutType.displayText;\r\n            else\r\n                this.valueText = '';\r\n            switch (trainingData.workoutType) {\r\n                case pm3.WorkoutTypes.FixedDistanceNoSplits:\r\n                case pm3.WorkoutTypes.FixtedDistanceSplits:\r\n                case pm3.WorkoutTypes.FixedDistanceInterval:\r\n                    this.valueText = this.valueText + ' ' + trainingData.distance.toString() + 'm';\r\n                    break;\r\n                case pm3.WorkoutTypes.FixedTimeNoSplits:\r\n                case pm3.WorkoutTypes.FixedTimeSplits:\r\n                case pm3.WorkoutTypes.FixedTimeInterval:\r\n                    this.valueText = this.valueText + ' ' + utilities.formatRelativeTime(trainingData.duration);\r\n                    break;\r\n            }\r\n            //skipp intervalType\r\n            if (trainingData.workoutType == pm3.WorkoutTypes.FixedTimeInterval ||\r\n                trainingData.workoutType == pm3.WorkoutTypes.FixedDistanceInterval ||\r\n                trainingData.workoutType == pm3.WorkoutTypes.VariableInterval) {\r\n                this.valueText = this.valueText + ' x' + trainingData.workoutIntervalCount.toString() +\r\n                    'rest ' + utilities.formatRelativeTime(trainingData.restTime);\r\n            }\r\n            if (trainingData.workoutState)\r\n                this.valueText = this.valueText + ' ' + trainingData.workoutState.displayText;\r\n            else\r\n                this.valueText = '';\r\n        };\r\n        ExampleTrainingDataWidget.prototype.initControl = function () {\r\n            _super.prototype.initControl.call(this);\r\n            this.labelText = \"Workout\";\r\n        };\r\n        return ExampleTrainingDataWidget;\r\n    })(ergometerWidgets.TrainingValueWidget);\r\n    /*------------------------------------------------------------------------------\r\n        Create and remove the widgets in the Plugin\r\n    ------------------------------------------------------------------------------*/\r\n    var ExamplePlugin = (function (_super) {\r\n        __extends(ExamplePlugin, _super);\r\n        function ExamplePlugin() {\r\n            _super.apply(this, arguments);\r\n        }\r\n        ExamplePlugin.prototype.init = function () {\r\n            //create the widget(s) on create\r\n            dashboard.widgetRegistry().register(ExamplePhaseValueWidget, 'tijmenvangulik_examples_StrokePhaseWidget', 'Phase', ['Examples']);\r\n            dashboard.widgetRegistry().register(ExampleStrokeValuePowerWidget, 'tijmenvangulik_examples_StrokeValuePowerWidget', 'Power', ['Examples']);\r\n            dashboard.widgetRegistry().register(ExampleTrainingDataWidget, 'tijmenvangulik_examples_TrainingDataWidget', 'Workout', ['Examples']);\r\n        };\r\n        ExamplePlugin.prototype.remove = function () {\r\n            dashboard.widgetRegistry().deregister('tijmenvangulik_examples_StrokePhaseWidget');\r\n            dashboard.widgetRegistry().deregister('tijmenvangulik_examples_StrokeValuePowerWidget');\r\n            dashboard.widgetRegistry().deregister('tijmenvangulik_examples_TrainingDataWidget');\r\n        };\r\n        return ExamplePlugin;\r\n    })(ExternalPlugin);\r\n    var plugin;\r\n    plugin = new ExamplePlugin();\r\n})(tijmenvangulik_examples_valuewidgets || (tijmenvangulik_examples_valuewidgets = {}));\r\n","styles":"/* default position and style */\n\n","typeScript":"module tijmenvangulik_examples_valuewidgets { //make a name space to prevent mix ups\n\n/*------------------------------------------------------------------------------\n    Stroke phase value widget example\n------------------------------------------------------------------------------*/\n    class ExamplePhaseValueWidget extends ergometerWidgets.StrokeValueWidget {\n        \n        public strokePhaseUpdate(phase : pm3.StrokePhase, duration : number) {\n\t\t\tthis.valueText = phase.displayText;\n\t\t}\n        \n        public loaded() {\n          super.loaded();\n          pm3.monitor.pubsubs.subNewStrokePhase(this, this.strokePhaseUpdate);\n        }\n        public beforeUnload() {\n          super.beforeUnload();\n          pm3.monitor.pubsubs.unsubNewStrokePhase(this.strokePhaseUpdate);\n        }\n\n\t\tpublic initControl() {\n            super.initControl();\n        \tthis.labelText = \"Phase2\"; //label before value\n\t\t}\n\t\tconstructor (controller : dashboard.Controller) {\n        \tsuper(controller);\n        \tthis.caption = \"Phase2\"; //menu item or window caption    \n\t\t}    \n    }\n/*------------------------------------------------------------------------------\n    Stroke power widget\n    note the base class  StrokeValueWidget connects the strokeDataUpdate to the event using\n    pm3.monitor.pubsubs.subStrokeDataUpdate(this, this.strokeDataUpdate);\n    see the ExamplePhaseValueWidget widget how to attach to events\n------------------------------------------------------------------------------*/\n    class ExampleStrokeValuePowerWidget  extends ergometerWidgets.StrokeValueWidget {\n\t\t\n\t\tpublic strokeDataUpdate(strokeData : pm3.StrokeData) {\n\t\t\tthis.valueText = strokeData.power.toString();\n\t\t}\n\n\t\tpublic initControl() {\n\t\t\tsuper.initControl();\n \t\t\tthis.labelText = \"Power\";\n\n\t\t}\n\t\tconstructor (controller : dashboard.Controller) {\n\t\t\tsuper(controller);\n\t\t\tthis.caption = \"Power2\";//no caption needed\n\t\t}\n\t} \n\t\n/*------------------------------------------------------------------------------\n    training data widget (or workout)\n    note the base class  StrokeValueWidget connects the trainingDataUpdate to the event using\n      pm3.monitor.pubsubs.subTrainingDataUpdate(this, this.trainingDataUpdate);\n    see the ExamplePhaseValueWidget widget how to attach to events\n------------------------------------------------------------------------------*/\n    class ExampleTrainingDataWidget  extends ergometerWidgets.TrainingValueWidget {\n\n\t\tpublic trainingDataUpdate(trainingData : pm3.TrainingData) {\n\t\t\tif (trainingData.workoutType)\n\t\t\t\tthis.valueText = trainingData.workoutType.displayText\n\t\t\telse this.valueText = '';\n\n\t\t\tswitch (trainingData.workoutType ) {\n\t\t\t\tcase pm3.WorkoutTypes.FixedDistanceNoSplits :\n\t\t\t\tcase pm3.WorkoutTypes.FixtedDistanceSplits :\n\t\t\t\tcase pm3.WorkoutTypes.FixedDistanceInterval :\n\t\t\t\t  \tthis.valueText=this.valueText+' '+trainingData.distance.toString()+'m';\n\t\t\t\t  \tbreak;\n\t\t\t\tcase pm3.WorkoutTypes.FixedTimeNoSplits :\n\t\t\t\tcase pm3.WorkoutTypes.FixedTimeSplits :\n\t\t\t\tcase pm3.WorkoutTypes.FixedTimeInterval :\n\t\t\t\t  \tthis.valueText=this.valueText+' '+ utilities.formatRelativeTime(trainingData.duration);\n\t\t\t\t  \tbreak;\n\t\t\t}\n\t\t\t//skipp intervalType\n\t\t\tif (trainingData.workoutType==pm3.WorkoutTypes.FixedTimeInterval ||\n\t\t\t\ttrainingData.workoutType==pm3.WorkoutTypes.FixedDistanceInterval || \n\t\t\t\ttrainingData.workoutType==pm3.WorkoutTypes.VariableInterval) {\n\t\t\t\tthis.valueText= this.valueText+' x'+trainingData.workoutIntervalCount.toString()+\n\t\t\t\t\t\t\t\t'rest '+utilities.formatRelativeTime(trainingData.restTime);\n\t\t\t}\n\t\t\tif (trainingData.workoutState)\n\t\t\t\tthis.valueText= this.valueText+' '+trainingData.workoutState.displayText\n\t\t\telse this.valueText='';\n\n\t\t}\n\n\t\tpublic initControl() {\n\t\t\tsuper.initControl();\n\t\t\tthis.labelText = \"Workout\";\n\n\t\t}\n\t\tconstructor (controller : dashboard.Controller) {\n\t\t\tthis.caption = \"Workout2\";\n            super(controller);\n\t\t}\n\t}\n\n/*------------------------------------------------------------------------------\n    Create and remove the widgets in the Plugin\n------------------------------------------------------------------------------*/\n    class ExamplePlugin extends ExternalPlugin {\n        \n        public init() {\n            //create the widget(s) on create\n            dashboard.widgetRegistry().register(ExamplePhaseValueWidget,'tijmenvangulik_examples_StrokePhaseWidget','Phase',['Examples']);\n            dashboard.widgetRegistry().register(ExampleStrokeValuePowerWidget,'tijmenvangulik_examples_StrokeValuePowerWidget','Power',['Examples']);\n            dashboard.widgetRegistry().register(ExampleTrainingDataWidget,'tijmenvangulik_examples_TrainingDataWidget','Workout',['Examples']);\n\n        }\n        public remove() {\n            dashboard.widgetRegistry().deregister('tijmenvangulik_examples_StrokePhaseWidget');\n            dashboard.widgetRegistry().deregister('tijmenvangulik_examples_StrokeValuePowerWidget');\n            dashboard.widgetRegistry().deregister('tijmenvangulik_examples_TrainingDataWidget');\n        }               \n    }\n\n    var plugin : ExamplePlugin;\n    plugin = new ExamplePlugin();\n    \n}\n\n\n    ","html":""}